let dados = {
  "ids": [
    {
        "id": 0,
        "nome": "Perdida",
        "inicio": 1883,
        "fim": 1900,
        "texto": "<b>Geração Perdida<br>(1833 - 1900)</b><br><br>Nascidos durante o século 19, os <i>perdidos</i> passaram pela Primeira Guerra Mundial, mas também curtiram muito os <i>Loucos Anos 20</i>, já no séc. XX.<br><br>Cunhado pela poetisa americana Gertrude Stein, o nome alude ao sentimento de desorientação germinado no pós-guerra, um dos traços mais marcantes dessa geração.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 1,
        "nome": "Grandiosa",
        "inicio": 1901,
        "fim": 1927,
        "texto": "<b>Geração Grandiosa<br>(1901 - 1927)</b><br><br>É a geração que passou pela Segunda Guerra Mundial e viveu o período conhecido como a Grande depressão, em inglês <i>(Greatest depression)</i>.<br><br>Batizada pelo jornalista americano Tom Brokaw, o nome da geração é referência direta ao termo em inglês <i>greatest</i>.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 2,
        "nome": "Silenciosa",
        "inicio": 1928,
        "fim": 1945,
        "texto": "<b>Geração Silenciosa<br>(1928 - 1945)</b><br><br>Uma referência explícita ao comportamento conformista que marcou a geração, em sua maioria, principalmente enquanto jovens.<br><br>Na idade adulta, os <i>silenciosos</i> presenciaram a Guerra da Coreia, o nascimento do rock nos anos 50 e os movimentos de direitos civis nos anos 60.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 3,
        "nome": "Baby Boomers",
        "inicio": 1946,
        "fim": 1964,
        "texto": "<b>Baby Boomers<br>(1946 - 1964)</b><br><br>Nascidos aos montes após a Segunda Guerra Mundial durante um <i>boom</i> populacional que marcou a época, por isso <i>boomers</i>.<br><br>Enquanto jovens, participaram dos movimentos de contracultura dos anos 60, questionando muitos dos valores vigentes na época.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 4,
        "nome": "Geração X",
        "inicio": 1965,
        "fim": 1980,
        "texto": "<b>Geração X<br>(1965 - 1980)</b><br><br>Nascidos entre meados dos anos 60 até o ano de 1980, a geração foi marcada por mudanças nos valores sociais como o aumento no número de divórcios e o \"retorno das mães\" à força de trabalho em \"jornada dupla\".<br><br>Enquanto adolescentes e jovens adultos nos anos 80/90, os \"X\" também ficaram conhecidos como \"geração MTV\". É uma referência ao canal americano que popularizou os videoclipes musicais, também outro traço marcante da época.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 5,
        "nome": "Y / Millennials",
        "inicio": 1981,
        "fim": 1996,
        "texto": "<b>Geração Y<br>Millennials<br>(1981 - 1996)</b><br><br>Costumam ser filhos únicos ou com apenas um irmão, os <i>millennials</i> são a geração em que pesquisadores enxergaram pela primeira vez comportamentos sincronizadamente parecidos em nível global.<br><br>Foram pioneiros nos comportamentos de \"nativos digitais\". É por isso que o nome faz referência ao momento em que se tornaram adolescentes e jovens adultos, durante a virada dos anos 2000, marcada na tecnologia pelo <i>bug do milênio</i>.",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 6,
        "nome": "Z / Zoomers",
        "inicio": 1997,
        "fim": 2012,
        "texto": "<b>Geração Z<br>Zoomers<br>(1997 - 2012)</b><br><br>São os primeiros a nascerem verdadeiros <i>nativos digitais</i>. O nome faz referência direta aos <i>baby boomers</i>, por conta similaridades comportamentais entre o passado e os \"Z\".<br><br>São avessos aos riscos, e assim, mais <i>comportados</i> que seus antecessores - a geração dos <i>millennials</i>.<br><br>Um dos traços mais marcantes é que os <i>zoomers</i> foram pioneiros em passar mais tempo nas telas do que interagindo com objetos de \"<i>papel</i>\".",
        "aos18": 1901,
        "aos70": 1953
    },
    {
        "id": 7,
        "nome": "Alpha",
        "inicio": 2013,
        "fim": 2025,
        "texto": "<b>Geração Alpha<br>(2013 - 2025)</b><br><br>Primeiros a nascer integralmente no século 21, os <i>alpha</i> são em sua maioria filhos da geração <i>millennial</i>.<br><br>Seu nome ainda está em disputa pelos estudiosos, pois alguns acreditam que a covid-19 é o marco fundamental da geração, migrando então para a letra \"C\".",
        "aos18": 1901,
        "aos70": 1953
    }
],
"fatos": [
    {
        "quando": 1883,
        "oque": ""
    },
    {
        "quando": 1884,
        "oque": ""
    },
    {
        "quando": 1885,
        "oque": ""
    },
    {
        "quando": 1886,
        "oque": "Karl Benz inventa o primeiro automóvel, o Benz Patent-Motorwagen"
    },
    {
        "quando": 1887,
        "oque": ""
    },
    {
        "quando": 1888,
        "oque": "Princesa Isabel assina a Lei Áurea, que aboliu a escravidão no Brasi"
    },
    {
        "quando": 1889,
        "oque": "Proclamação da República no Brasil"
    },
    {
        "quando": 1890,
        "oque": ""
    },
    {
        "quando": 1891,
        "oque": ""
    },
    {
        "quando": 1892,
        "oque": ""
    },
    {
        "quando": 1893,
        "oque": ""
    },
    {
        "quando": 1894,
        "oque": "Irmãos Lumiére apresentam o cinematógrafo, que deu origem ao cinema"
    },
    {
        "quando": 1895,
        "oque": ""
    },
    {
        "quando": 1896,
        "oque": ""
    },
    {
        "quando": 1897,
        "oque": ""
    },
    {
        "quando": 1898,
        "oque": ""
    },
    {
        "quando": 1899,
        "oque": ""
    },
    {
        "quando": 1890,
        "oque": ""
    },
    {
        "quando": 1891,
        "oque": ""
    },
    {
        "quando": 1892,
        "oque": ""
    },
    {
        "quando": 1893,
        "oque": ""
    },
    {
        "quando": 1894,
        "oque": ""
    },
    {
        "quando": 1895,
        "oque": ""
    },
    {
        "quando": 1896,
        "oque": ""
    },
    {
        "quando": 1897,
        "oque": ""
    },
    {
        "quando": 1898,
        "oque": ""
    },
    {
        "quando": 1899,
        "oque": ""
    },
    {
        "quando": 1900,
        "oque": ""
    },
    {
        "quando": 1901,
        "oque": ""
    },
    {
        "quando": 1902,
        "oque": ""
    },
    {
        "quando": 1903,
        "oque": ""
    },
    {
        "quando": 1904,
        "oque": ""
    },
    {
        "quando": 1905,
        "oque": ""
    },
    {
        "quando": 1906,
        "oque": ""
    },
    {
        "quando": 1907,
        "oque": ""
    },
    {
        "quando": 1908,
        "oque": ""
    },
    {
        "quando": 1909,
        "oque": ""
    },
    {
        "quando": 1910,
        "oque": ""
    },
    {
        "quando": 1911,
        "oque": ""
    },
    {
        "quando": 1912,
        "oque": ""
    },
    {
        "quando": 1913,
        "oque": ""
    },
    {
        "quando": 1914,
        "oque": "Início da Primeira Guerra Mundial, que se estende até 1918"
    },
    {
        "quando": 1915,
        "oque": ""
    },
    {
        "quando": 1916,
        "oque": ""
    },
    {
        "quando": 1917,
        "oque": ""
    },
    {
        "quando": 1918,
        "oque": ""
    },
    {
        "quando": 1919,
        "oque": ""
    },
    {
        "quando": 1920,
        "oque": ""
    },
    {
        "quando": 1921,
        "oque": ""
    },
    {
        "quando": 1922,
        "oque": "Semana de Arte Moderna do Brasil"
    },
    {
        "quando": 1923,
        "oque": ""
    },
    {
        "quando": 1924,
        "oque": ""
    },
    {
        "quando": 1925,
        "oque": ""
    },
    {
        "quando": 1926,
        "oque": ""
    },
    {
        "quando": 1927,
        "oque": ""
    },
    {
        "quando": 1928,
        "oque": ""
    },
    {
        "quando": 1929,
        "oque": "Crise da Bolsa de Valores de Nova York, nos Estados Unidos"
    },
    {
        "quando": 1930,
        "oque": "Revolução de 1930 e chegada de Getúlio Vargas à presidência do Brasil"
    },
    {
        "quando": 1931,
        "oque": ""
    },
    {
        "quando": 1932,
        "oque": ""
    },
    {
        "quando": 1933,
        "oque": ""
    },
    {
        "quando": 1934,
        "oque": ""
    },
    {
        "quando": 1935,
        "oque": ""
    },
    {
        "quando": 1936,
        "oque": ""
    },
    {
        "quando": 1937,
        "oque": ""
    },
    {
        "quando": 1938,
        "oque": ""
    },
    {
        "quando": 1939,
        "oque": "Alemanha invade a Polônia e dá início à Segunda Guerra Mundial, que se estende até 1945"
    },
    {
        "quando": 1940,
        "oque": ""
    },
    {
        "quando": 1940,
        "oque": ""
    },
    {
        "quando": 1942,
        "oque": ""
    },
    {
        "quando": 1943,
        "oque": ""
    },
    {
        "quando": 1944,
        "oque": ""
    },
    {
        "quando": 1945,
        "oque": ""
    },
    {
        "quando": 1946,
        "oque": ""
    },
    {
        "quando": 1947,
        "oque": "Começa o período da Guerra Fria, tensão entre EUA e URSS que se estende até 1991"
    },
    {
        "quando": 1948,
        "oque": ""
    },
    {
        "quando": 1949,
        "oque": ""
    },
    {
        "quando": 1950,
        "oque": ""
    },
    {
        "quando": 1951,
        "oque": ""
    },
    {
        "quando": 1952,
        "oque": ""
    },
    {
        "quando": 1953,
        "oque": ""
    },
    {
        "quando": 1954,
        "oque": ""
    },
    {
        "quando": 1955,
        "oque": ""
    },
    {
        "quando": 1956,
        "oque": ""
    },
    {
        "quando": 1957,
        "oque": "Começa a Guerra do Vietnã, que se estende até 1975"
    },
    {
        "quando": 1958,
        "oque": ""
    },
    {
        "quando": 1959,
        "oque": ""
    },
    {
        "quando": 1960,
        "oque": ""
    },
    {
        "quando": 1961,
        "oque": ""
    },
    {
        "quando": 1962,
        "oque": "Crise dos Mísseis de Cuba, um dos pontos mais críticos da Guerra Fria"
    },
    {
        "quando": 1963,
        "oque": ""
    },
    {
        "quando": 1964,
        "oque": "Golpe militar no Brasil dá início ao período da Ditadura Militar, que dura até 1985"
    },
    {
        "quando": 1965,
        "oque": ""
    },
    {
        "quando": 1966,
        "oque": ""
    },
    {
        "quando": 1967,
        "oque": ""
    },
    {
        "quando": 1968,
        "oque": ""
    },
    {
        "quando": 1969,
        "oque": "Voo espacial Apollo 11 faz o primeiro pouso tripulado na Lua. No mesmo ano, acontece o Festival de Woodstock"
    },
    {
        "quando": 1970,
        "oque": ""
    },
    {
        "quando": 1971,
        "oque": ""
    },
    {
        "quando": 1972,
        "oque": ""
    },
    {
        "quando": 1973,
        "oque": ""
    },
    {
        "quando": 1974,
        "oque": ""
    },
    {
        "quando": 1975,
        "oque": ""
    },
    {
        "quando": 1976,
        "oque": ""
    },
    {
        "quando": 1977,
        "oque": "Começa a ser vendido o Apple II, um dos primeiros microcomputadores pessoais, junto com o Commodore PET e o MSX, no início dos anos 1980"
    },
    {
        "quando": 1978,
        "oque": "Polonês Karol Wojtyła é escolhido como Papa João Paulo II"
    },
    {
        "quando": 1979,
        "oque": ""
    },
    {
        "quando": 1980,
        "oque": ""
    },
    {
        "quando": 1981,
        "oque": ""
    },
    {
        "quando": 1982,
        "oque": ""
    },
    {
        "quando": 1983,
        "oque": "Movimento Diretas Já, pedindo eleições e o fim da Ditadura Militar no Brasil"
    },
    {
        "quando": 1984,
        "oque": ""
    },
    {
        "quando": 1985,
        "oque": "Fim do regime militar e começo da redemocratização do Brasil"
    },
    {
        "quando": 1986,
        "oque": ""
    },
    {
        "quando": 1987,
        "oque": ""
    },
    {
        "quando": 1988,
        "oque": ""
    },
    {
        "quando": 1989,
        "oque": "Queda do Muro de Berlim, na Alemanha, e Protesto na Praça da Paz Celestial, na China"
    },
    {
        "quando": 1990,
        "oque": "Começa a Guerra do Golfo, entre Iraque e coalizão de países liderados pelos EUA"
    },
    {
        "quando": 1991,
        "oque": "Dissolução da União Soviética e fim da Guerra Fria"
    },
    {
        "quando": 1992,
        "oque": ""
    },
    {
        "quando": 1993,
        "oque": ""
    },
    {
        "quando": 1994,
        "oque": "Começa a implantação do Plano Real no Brasil"
    },
    {
        "quando": 1995,
        "oque": "Microsoft lança o sistema operacional Windows 95"
    },
    {
        "quando": 1996,
        "oque": "Nasce a ovelha Dolly, primeiro mamífero clonado com sucesso"
    },
    {
        "quando": 2001,
        "oque": "World Trade Center e Pentágono dos EUA sofrem atentado terrorista em 11/09"
    },
    {
        "quando": 2002,
        "oque": "Luiz Inácio Lula da Silva é eleito presidente do Brasil"
    },
    {
        "quando": 2003,
        "oque": "Projeto Genoma Humano é declarado essencialmente completo"
    },
    {
        "quando": 2004,
        "oque": "Redes sociais Orkut e Facebook são abertas para os usuários"
    },
    {
        "quando": 2007,
        "oque": "Apple lança o primeiro iPhone, revolucionando o mercado de celulares"
    },
    {
        "quando": 2009,
        "oque": "Democrata Barack Obama é o primeiro presidente negro dos Estados Unidos"
    },
    {
        "quando": 2011,
        "oque": "Onda de protestos Primavera Árabe toma países e pede mudanças políticas e sociais"
    },
    {
        "quando": 2014,
        "oque": "Copa do Mundo FIFA é realizada no Brasil; dois anos depois, país também sediou as Olimpíadas do Rio de Janeiro"
    },
    {
        "quando": 2015,
        "oque": "Barragem em Mariana (MG) controlada pela Samarco destrói o ecossistema da bacia do rio Doce"
    },
    {
        "quando": 2019,
        "oque": "Vingadores: Ultimato supera Avatar e se torna o filme de maior bilheteria na história"
    },
    {
        "quando": 2020,
        "oque": "Pandemia global do vírus Covid-19 mata milhões e coloca países em crise generalizada"
    },
    {
        "quando": 2021,
        "oque": "Com um ano de atraso, Japão sedia os Jogos Olímpicos e Paraolímpicos de Tóquio"
    },
    {
        "quando": 2022,
        "oque": "Rússia inicia a invasão militar da Ucrânia"
    }
  ]
}

// Configuração de variáveis de uso global
const entrada = document.querySelector('input');
const botcalcular = document.querySelector('#calcular');
const botlimpar = document.querySelector('#limpar');
const idsgeracoes = dados.ids;

// Elementos do gráfico-timeline
const timeline = document.querySelector('#timeline');
const dividgeracoes = document.querySelector('#geracoes')
const marcadores = document.querySelector('#marcadores')
const geracoesdivs = document.querySelectorAll('#geracoes>div');
const excetomostrar = document.querySelectorAll('#geracoes>div:not([class="mostrar"])');

// Elementos do terceiro slide
const card = document.querySelector('#card-i');
const cardv = document.querySelector('#card-v');

// Configuração do botão de cálculo para que começe desativado e,
// em combinação com o css, o torne invisível.
botcalcular.disabled = true;
botlimpar.disabled = true;

// Dois trechos de código que criam os elementos que compoem a section em grid que contém 
// o gráfico. Este primeiro cria, para cada entrada no intervalo das gerações, uma div nova.
// Cada uma contém os elementos de data de início da geração e o respectivo nome. Uma das linhas
// faz o o cálculo do tamanho que a div deve ter para que fique proporcional no dispositivo. Outra
// linha coloca o nome da geração dentro da div. Para o atributo data-inicio é enviado o ano de início
// da geração. Este dado é consumido no CSS com a declaração ::before. No segundo trecho,
// para cada valor no intervalo, uma nova div. É uma segunda section que compartilha o mesmo nome de grid-area.
// É assim que elas ficam sobrepostas e por isso precisam  ter as divs de mesmo tamanho - o código até aí então
// é o mesmo. Na última linha é definido que o destino das divs é a seção de ID marcadores. 

for (let geracao of idsgeracoes) {

    let divgeracao = document.createElement('div');
    divgeracao.dataset.inicio = geracao.inicio;
    divgeracao.dataset.fim = geracao.fim;
    divgeracao.innerHTML = `<a class="nomegeracao">${geracao.nome}</a>`;
    let alturadiv = geracao.fim - geracao.inicio;
    divgeracao.style.height = `${alturadiv}%`;
    dividgeracoes.appendChild(divgeracao);
    
    let divmarcador = document.createElement('div');
    divmarcador.style.height = `${alturadiv}%`;
    marcadores.appendChild(divmarcador);
}

  // Função de cálculo. O parâmetro é o valor do número validado pela função acima.
function calcular(anoNasc) { 

  // Define o índice de gerações como o intervalo dos valores + 1.
  let indice = idsgeracoes.length + 1;
  entrada.setAttribute("readonly", true)
  botlimpar.disabled = false;
  botcalcular.disabled = true;

  for (let geracao of idsgeracoes) {
    // Loop pelo intervalo de gerações, em que a primeira linha
    // é uma instrução para diminuir em uma unidade para cada geração iterada.
    indice--;

    if (anoNasc <= geracao.fim) {
      // Quando o valor do ano inserido for menor ou igual
      // ao ano em que termina uma geração (geracao.fim),
      // definir variáveis a serem destacadas de acordo com
      // o valor do índice correspondente à geração e ao anoNasc
      // inserido no input no início da experiência.
      let texto = geracao.texto;
      let numG = parseInt(idsgeracoes.length - indice);
      let iniG = geracao.inicio;
      let fimG = geracao.fim;
      let alturaNasc = Math.ceil(100 - ((fimG - anoNasc) * 100 / (fimG - iniG)));
      destacarGeracao( numG, iniG, fimG, texto);
      posicaoMarcador( numG, anoNasc, alturaNasc, iniG, fimG ); 
      break
    };
  };
}

// Função que destaca a geração correspondente ao número do índice
// inserindo as informações calculadas de acordo com o número do ano
// informado pelo usuário no campo de input.
function destacarGeracao( numG, iniG, fimG, texto ) {
  
  let indice = -1
  let geracoesdivs = document.querySelectorAll('#geracoes>div');
  
  for ( let divgeracao of geracoesdivs ) {
    ++indice
    if (indice == numG){
      divgeracao.classList.add('mostrar');
      cardv.innerHTML = `<div>${texto}</div>`;
      // Iniciar a função que desliza a visualização do viewport
      // para o faixa da geração correspondente ao valor inserido.
      mostraSecao(divgeracao);
      // let mostrarme1 = geracoesdivs[n-1];
      // let mostrarma1 = geracoesdivs[n+1];

      function hasClass(elem, className) {
        return elem.classList.contains(className);
      }
      
      document.addEventListener('click', function(e) {
        if (hasClass(e.target, 'mostrar')) {
          expandirGeracao(`${numG}`, `${iniG}`, `${fimG}`);
        }
      }, false);
    }
  }
}

// Função que movimenta o marcador com
// o ano de nascimento informado pelo usuário.
function posicaoMarcador(numG, anoNasc, alturaNasc, iniG, fimG) {

    let indice = -1;
    let divparamarcadores = document.querySelectorAll('#marcadores>div');

    divparamarcadores.forEach((linhaNasc) => {
      ++indice;
      if (indice == numG) {
        linhaNasc.classList.add('mostrar');
        linhaNasc.innerHTML = `<div id="linhaNasc" style="height:${alturaNasc}%;">${anoNasc}</div>`;
      }
    });

    console.log(`Nasceu em ${anoNasc} geração ID ${numG} início em ${iniG} e termina em ${fimG}`);
};

function expandirGeracao(numG, iniG, fimG) {

  let geracoesdivs = document.querySelectorAll('#geracoes>div');
  let divparamarcadores = document.querySelectorAll('#marcadores>div');
  let excetomostrar = document.querySelectorAll('#geracoes>div:not([class="mostrar"])');
  let excetolinhaNasc = document.querySelectorAll('#marcadores>div:not([class="mostrar"])');

  for (let remover of excetomostrar) {
    remover.style.display = 'none';
  }

  let mostrar = geracoesdivs[numG];
  mostrar.style.height = 100 + '%';
  mostrar.style.cursor = 'auto';
  mostrar.removeAttribute('onclick');
  mostrar.classList.add('expandir');

  for (let remover of excetolinhaNasc) {
    remover.style.display = 'none';
  }

  let linhaNasc = divparamarcadores[numG];
  linhaNasc.classList.add('expandir');
  linhaNasc.style.height = 100 + '%';

  let idsfatos = dados.fatos;
  for (let fato of idsfatos) {
    if (fimG >= fato.quando && fato.quando >= iniG) {
      let linha = document.createElement('div');
      let posicao = Math.ceil(100 - ( ( fimG - fato.quando ) * 100 / ( fimG - iniG ) ));
      linha.style.height = `${posicao}%`;
      linha.dataset.quando = fato.quando
      linha.innerHTML = `<span class="fato que">${fato.oque}</span><span class="fato quando">${fato.quando}</span>` 
      timeline.appendChild(linha)  
    }
  }
}

  // Função que reseta a calculadora para seu estado inicial.
  // function limpar() {

  //   card.classList.remove('virar');

  //   let geracoesdivs = document.querySelectorAll('#geracoes>div');
  //   let linhaNasc = document.querySelector('#marcadores>div.mostrar');
  //   let linhaFatos = document.querySelectorAll('#timeline>div');

  //   for (let divgeracao of geracoesdivs) {

  //     divgeracao.classList.remove('mostrar');
  //     divgeracao.classList.remove('expandir');

  //     if (linhaNasc != null) {
  //       linhaNasc.classList.remove('mostrar');
  //       linhaNasc.innerHTML = '';
  //       divgeracao.style.display = 'grid';
  //       divgeracao.removeAttribute('onclick');
  //       divgeracao.style.height = divgeracao.dataset.fim - divgeracao.dataset.inicio + '%';
  //     }
  //   }

  // for (let linha of linhaFatos) {
  //   if (linhaFatos != null) {
  //     linha.innerHTML = '';
  //   }
  // }
  // };

// Função validar checa: 1. entrada input tem um valor de preenchimento.
// 2. É maior ou igual do que 1882 e menor ou igual a 2026.
function validar() {

  let anoNasc = parseInt(entrada.value, 10);
  // Converte o anoNasc em um valor inteiro (número)
  
  if (isNaN(anoNasc) || anoNasc <= 1882 || anoNasc >= 2026) {
    // Checa condições descritas acima. Se verdadeira, reseta as configurações
    // do gráfico e ativa o botão de calcular. Se for falso, mantém tudo como está.
    botcalcular.disabled = true;
  }
  else {
    botcalcular.disabled = false;
  }
  return anoNasc;
}

// Define a função que desliza a visualização do viewport
// para o faixa da geração correspondente ao valor inserido.
function mostraSecao( secao ) {
  secao.scrollIntoView( { behavior: "smooth" } );
}

// Define variáveis e função para observar quando o terceiro slide
// estive em foco no viewport do usuário, acionando a virada do card.
cardIntObs = () => new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('virar');
      return;
    }
    entry.target.classList.remove('virar');
  });
}).observe(card);

cardIntObs();

// Configurão de escutador do elemento entrada. Ele checa o preenchimento de
// texto em um input, executando para cada novo digito inserido a validação do ano inserido.
entrada.addEventListener('input', validar);

// Abaixo, o código pergunta para o mesmo escutador de entrada se ele ouviu algum
// botão ser pressionado no teclado - desktop ou celular.
entrada.addEventListener('keypress', (event) => {
// Se for pressionada uma tecla, a função checa duas condições: primeiro se a tecla
// pressionada foi 'Enter'; e segundo, se o botão de cáculo está visiível.
// Para que esta última condição seja verdade, a função na página já confirmou
// que o input foi preenchido por um número do ano válido: é inteiro está no
// intervalo descrito nos dados.
  if (botcalcular.disabled == false && event.key === 'Enter') {
    calcular(validar());
    // Quando essas duas condições são verdadeiras, é feito então o cálculo
    // de posicionamento do marcador de nascimento.
  }
});